diff --git a/CPSC532-HW4/BBVI.py b/CPSC532-HW4/BBVI.py
index 862d231..35504fb 100644
--- a/CPSC532-HW4/BBVI.py
+++ b/CPSC532-HW4/BBVI.py
@@ -6,7 +6,7 @@ import itertools
 
 from graph_based_sampling import standard_env, graph, evaluate_graph
 from evaluation_based_sampling import Eval
-from utils import log_sample
+from utils import log_sample, log_params, log_loss
 from distributions import Normal, Dirichlet, Gamma, Categorical, Uniform, HalfUniform
 
 def log_joint(X : dict, Y : dict, g : graph)->tc.tensor:
@@ -39,7 +39,7 @@ def log_joint(X : dict, Y : dict, g : graph)->tc.tensor:
     return log_P
 
 
-def BBVI(program, prog_set="HW4", num_samples_per_step=100, num_steps=300, learning_rate=1e-1, verbose=False, wandb_name = None):
+def BBVI(program, prog_set="HW4", num_samples_per_step=100, num_steps=300, learning_rate=1e-1, verbose=False, wandb_name = None, wandb_run=False):
     
     #get the program
     json_prog = './programs/' + prog_set + '/%d_graph.json'%(program)
@@ -122,6 +122,12 @@ def BBVI(program, prog_set="HW4", num_samples_per_step=100, num_steps=300, learn
 
         results[i] = {x : [p.clone().detach() for p in Q[x].params()] for x in Q.keys()}
         loss.append(ELBO_loss.clone().detach())
+
+        if wandb_run:
+            log_params(Q, i, wandb_name=wandb_name)
+            log_loss(ELBO_loss.clone().detach(), i, wandb_name=wandb_name)
+
+
     
 
     loss = tc.stack(loss).float()
diff --git a/CPSC532-HW4/config.yaml b/CPSC532-HW4/config.yaml
index e43a46b..454dd5f 100644
--- a/CPSC532-HW4/config.yaml
+++ b/CPSC532-HW4/config.yaml
@@ -1,6 +1,6 @@
 # Weights and biases
-wandb_run: False
-entity : "williamlaplante" #to post results -> 'cs532-2022', to analyze your own stuff -> 'williamlaplante'
+wandb_run: True
+entity : "cs532-2022" #to post results -> 'cs532-2022', to analyze your own stuff -> 'williamlaplante'
 
 # Directory structure
 #CPSC532Homeworks
@@ -10,7 +10,7 @@ daphne_dir: '../../daphne' # NOTE: This path should be relative to the homework
 # Tests and programs to run
 deterministic_tests: []
 probabilistic_tests: []
-HW4_programs: [4]
+HW4_programs: [1]
 
 #which HW to run
 prog_set: 'HW4'
@@ -27,4 +27,4 @@ num_samples: 1e3
 
 BBVI : True
 
-save : True
\ No newline at end of file
+save : False
\ No newline at end of file
diff --git a/CPSC532-HW4/results/Q_4.pkl b/CPSC532-HW4/results/Q_4.pkl
index df4b789..954053a 100644
Binary files a/CPSC532-HW4/results/Q_4.pkl and b/CPSC532-HW4/results/Q_4.pkl differ
diff --git a/CPSC532-HW4/results/loss_4.dat b/CPSC532-HW4/results/loss_4.dat
index c5706aa..7a7b4f8 100644
--- a/CPSC532-HW4/results/loss_4.dat
+++ b/CPSC532-HW4/results/loss_4.dat
@@ -1,300 +1,300 @@
--9.590847656250000000e+04
--9.768578906250000000e+04
--9.832563281250000000e+04
--9.657274218750000000e+04
--9.708919531250000000e+04
--9.685428125000000000e+04
--9.856017968750000000e+04
--1.000178437500000000e+05
--9.948782031250000000e+04
--1.016672421875000000e+05
--1.004969218750000000e+05
--1.024558125000000000e+05
--1.008550234375000000e+05
--1.026260937500000000e+05
--1.031206953125000000e+05
--1.045805156250000000e+05
--1.036605000000000000e+05
--1.027103750000000000e+05
--1.040431562500000000e+05
--1.046765390625000000e+05
--1.045803515625000000e+05
--1.043371250000000000e+05
--1.058903203125000000e+05
--1.068987187500000000e+05
--1.056246953125000000e+05
--1.063390000000000000e+05
--1.063352187500000000e+05
--1.060075312500000000e+05
--1.067895312500000000e+05
--1.081483593750000000e+05
--1.076227578125000000e+05
--1.072213671875000000e+05
--1.086067109375000000e+05
--1.110911484375000000e+05
--1.104074453125000000e+05
--1.102676953125000000e+05
--1.130603828125000000e+05
--1.098644531250000000e+05
--1.099750625000000000e+05
--1.105490546875000000e+05
--1.128322656250000000e+05
--1.130289062500000000e+05
--1.127937890625000000e+05
--1.143406796875000000e+05
--1.131274296875000000e+05
--1.137193750000000000e+05
--1.135537968750000000e+05
--1.118458828125000000e+05
--1.141248671875000000e+05
--1.141006953125000000e+05
--1.153026406250000000e+05
--1.144413750000000000e+05
--1.138761171875000000e+05
--1.147913437500000000e+05
--1.135306562500000000e+05
--1.137595312500000000e+05
--1.160263593750000000e+05
--1.132142500000000000e+05
--1.160613437500000000e+05
--1.159317968750000000e+05
--1.143424765625000000e+05
--1.146430703125000000e+05
--1.136634687500000000e+05
--1.157218437500000000e+05
--1.133469218750000000e+05
--1.153991562500000000e+05
--1.146159765625000000e+05
--1.161077578125000000e+05
--1.157809296875000000e+05
--1.158940546875000000e+05
--1.154717734375000000e+05
--1.126397031250000000e+05
--1.156783828125000000e+05
--1.156842656250000000e+05
--1.152440000000000000e+05
--1.143804296875000000e+05
--1.163210703125000000e+05
--1.168454765625000000e+05
--1.149265234375000000e+05
--1.154174140625000000e+05
--1.153771328125000000e+05
--1.148160234375000000e+05
--1.155205078125000000e+05
--1.147643437500000000e+05
--1.156364921875000000e+05
--1.173910234375000000e+05
--1.163548515625000000e+05
--1.183441484375000000e+05
--1.189907031250000000e+05
--1.176508828125000000e+05
--1.174217031250000000e+05
--1.180553359375000000e+05
--1.185496250000000000e+05
--1.191111171875000000e+05
--1.191783593750000000e+05
--1.197708515625000000e+05
--1.190567968750000000e+05
--1.188616796875000000e+05
--1.189655078125000000e+05
--1.193540156250000000e+05
--1.191824296875000000e+05
--1.196661328125000000e+05
--1.202177968750000000e+05
--1.197252265625000000e+05
--1.185994140625000000e+05
--1.209413593750000000e+05
--1.193393359375000000e+05
--1.199743203125000000e+05
--1.206927968750000000e+05
--1.197256796875000000e+05
--1.200569453125000000e+05
--1.200578125000000000e+05
--1.201834375000000000e+05
--1.221555703125000000e+05
--1.212382031250000000e+05
--1.207642968750000000e+05
--1.191637890625000000e+05
--1.188557500000000000e+05
--1.202444687500000000e+05
--1.206462656250000000e+05
--1.212497031250000000e+05
--1.200428828125000000e+05
--1.194546250000000000e+05
--1.201510703125000000e+05
--1.194475859375000000e+05
--1.206749843750000000e+05
--1.191003984375000000e+05
--1.190501562500000000e+05
--1.208686640625000000e+05
--1.200723984375000000e+05
--1.203997968750000000e+05
--1.199261718750000000e+05
--1.201027734375000000e+05
--1.193736562500000000e+05
--1.186966250000000000e+05
--1.207173203125000000e+05
--1.214700781250000000e+05
--1.222380000000000000e+05
--1.214833046875000000e+05
--1.214403359375000000e+05
--1.210333984375000000e+05
--1.224649843750000000e+05
--1.222014375000000000e+05
--1.199387734375000000e+05
--1.227001562500000000e+05
--1.216587734375000000e+05
--1.220438437500000000e+05
--1.221575078125000000e+05
--1.215483593750000000e+05
--1.209165234375000000e+05
--1.222325468750000000e+05
--1.229006171875000000e+05
--1.236290000000000000e+05
--1.232335859375000000e+05
--1.230948515625000000e+05
--1.225369453125000000e+05
--1.240242109375000000e+05
--1.234781093750000000e+05
--1.230707734375000000e+05
--1.243206015625000000e+05
--1.215631171875000000e+05
--1.232722421875000000e+05
--1.216761562500000000e+05
--1.249714140625000000e+05
--1.249825234375000000e+05
--1.239387031250000000e+05
--1.260849453125000000e+05
--1.244043046875000000e+05
--1.260034921875000000e+05
--1.277223203125000000e+05
--1.259778906250000000e+05
--1.269394375000000000e+05
--1.265088671875000000e+05
--1.272083984375000000e+05
--1.279561484375000000e+05
--1.263101093750000000e+05
--1.270883437500000000e+05
--1.297384140625000000e+05
--1.282103437500000000e+05
--1.285211093750000000e+05
--1.292076562500000000e+05
--1.294523046875000000e+05
--1.302218906250000000e+05
--1.285781171875000000e+05
--1.305607890625000000e+05
--1.279209453125000000e+05
--1.298001328125000000e+05
--1.273631875000000000e+05
--1.266849843750000000e+05
--1.278011328125000000e+05
--1.278496562500000000e+05
--1.264937890625000000e+05
--1.260001328125000000e+05
--1.241936640625000000e+05
--1.247556171875000000e+05
--1.259995234375000000e+05
--1.231097343750000000e+05
--1.229673984375000000e+05
--1.218533203125000000e+05
--1.247632421875000000e+05
--1.234635468750000000e+05
--1.245672031250000000e+05
--1.231087187500000000e+05
--1.226986796875000000e+05
--1.241076406250000000e+05
--1.249703359375000000e+05
--1.227504375000000000e+05
--1.243473593750000000e+05
--1.244099296875000000e+05
--1.254520781250000000e+05
--1.239238437500000000e+05
--1.247733359375000000e+05
--1.252797187500000000e+05
--1.249330546875000000e+05
--1.272716640625000000e+05
--1.267150156250000000e+05
--1.248189218750000000e+05
--1.261521562500000000e+05
--1.248137031250000000e+05
--1.262927968750000000e+05
--1.262056015625000000e+05
--1.272351875000000000e+05
--1.294775625000000000e+05
--1.274292109375000000e+05
--1.265499296875000000e+05
--1.259337578125000000e+05
--1.254025859375000000e+05
--1.258395312500000000e+05
--1.245174921875000000e+05
--1.257834687500000000e+05
--1.235626562500000000e+05
--1.234812265625000000e+05
--1.234319296875000000e+05
--1.207524531250000000e+05
--1.233186562500000000e+05
--1.218277500000000000e+05
--1.218908515625000000e+05
--1.216152812500000000e+05
--1.202420390625000000e+05
--1.227114140625000000e+05
--1.224783437500000000e+05
--1.222574765625000000e+05
--1.229114140625000000e+05
--1.229794531250000000e+05
--1.210856953125000000e+05
--1.214471093750000000e+05
--1.194381171875000000e+05
--1.214003359375000000e+05
--1.218773359375000000e+05
--1.214325703125000000e+05
--1.197664687500000000e+05
--1.197253437500000000e+05
--1.214060234375000000e+05
--1.205581171875000000e+05
--1.200350390625000000e+05
--1.199830390625000000e+05
--1.195318281250000000e+05
--1.190046250000000000e+05
--1.193652500000000000e+05
--1.202245234375000000e+05
--1.200401328125000000e+05
--1.219133593750000000e+05
--1.208848828125000000e+05
--1.221697187500000000e+05
--1.217322500000000000e+05
--1.209200156250000000e+05
--1.217480390625000000e+05
--1.201580234375000000e+05
--1.222740546875000000e+05
--1.199164375000000000e+05
--1.196750156250000000e+05
--1.209859609375000000e+05
--1.205001328125000000e+05
--1.206664531250000000e+05
--1.192825859375000000e+05
--1.199018437500000000e+05
--1.180298828125000000e+05
--1.191849062500000000e+05
--1.193380234375000000e+05
--1.197774296875000000e+05
--1.192447968750000000e+05
--1.199485625000000000e+05
--1.188166640625000000e+05
--1.200595078125000000e+05
--1.196053984375000000e+05
--1.203466953125000000e+05
--1.192583203125000000e+05
--1.199290781250000000e+05
--1.205821093750000000e+05
--1.212333203125000000e+05
--1.211723984375000000e+05
--1.213561328125000000e+05
--1.235820390625000000e+05
--1.239640937500000000e+05
--1.229766796875000000e+05
--1.243501484375000000e+05
--1.259089296875000000e+05
--1.225255625000000000e+05
--1.239702968750000000e+05
--1.237837578125000000e+05
+-9.501882812500000000e+04
+-9.513582031250000000e+04
+-9.693102343750000000e+04
+-9.840318750000000000e+04
+-9.775835937500000000e+04
+-9.822435937500000000e+04
+-9.900747656250000000e+04
+-9.971484375000000000e+04
+-9.953534375000000000e+04
+-1.009277812500000000e+05
+-1.017739921875000000e+05
+-1.022368437500000000e+05
+-1.010671093750000000e+05
+-1.036009218750000000e+05
+-1.049392500000000000e+05
+-1.041957031250000000e+05
+-1.046578125000000000e+05
+-1.044041875000000000e+05
+-1.033620468750000000e+05
+-1.031148828125000000e+05
+-1.052949609375000000e+05
+-1.047480312500000000e+05
+-1.036981328125000000e+05
+-1.049623515625000000e+05
+-1.037081015625000000e+05
+-1.055314296875000000e+05
+-1.052273203125000000e+05
+-1.042472578125000000e+05
+-1.054432578125000000e+05
+-1.072359609375000000e+05
+-1.066086171875000000e+05
+-1.042794921875000000e+05
+-1.062003281250000000e+05
+-1.070145625000000000e+05
+-1.067293515625000000e+05
+-1.060788437500000000e+05
+-1.064430000000000000e+05
+-1.077418203125000000e+05
+-1.058988437500000000e+05
+-1.074371484375000000e+05
+-1.084830625000000000e+05
+-1.047216406250000000e+05
+-1.070763906250000000e+05
+-1.069147265625000000e+05
+-1.071647421875000000e+05
+-1.080090781250000000e+05
+-1.080617812500000000e+05
+-1.070698906250000000e+05
+-1.065525234375000000e+05
+-1.077196015625000000e+05
+-1.082427812500000000e+05
+-1.093694609375000000e+05
+-1.110695703125000000e+05
+-1.102637421875000000e+05
+-1.128386796875000000e+05
+-1.113210390625000000e+05
+-1.089058906250000000e+05
+-1.121088593750000000e+05
+-1.108485000000000000e+05
+-1.105446875000000000e+05
+-1.117681093750000000e+05
+-1.108202187500000000e+05
+-1.119947968750000000e+05
+-1.113723515625000000e+05
+-1.113840000000000000e+05
+-1.117018984375000000e+05
+-1.107313437500000000e+05
+-1.108004218750000000e+05
+-1.110615390625000000e+05
+-1.140038671875000000e+05
+-1.119124375000000000e+05
+-1.122797968750000000e+05
+-1.141251875000000000e+05
+-1.152748281250000000e+05
+-1.143419609375000000e+05
+-1.149302265625000000e+05
+-1.130575468750000000e+05
+-1.130239765625000000e+05
+-1.143354296875000000e+05
+-1.142880390625000000e+05
+-1.148914218750000000e+05
+-1.148105312500000000e+05
+-1.162245468750000000e+05
+-1.142626093750000000e+05
+-1.163288906250000000e+05
+-1.127400234375000000e+05
+-1.156437109375000000e+05
+-1.148784531250000000e+05
+-1.162207031250000000e+05
+-1.177564531250000000e+05
+-1.157942187500000000e+05
+-1.155465781250000000e+05
+-1.187485625000000000e+05
+-1.190097890625000000e+05
+-1.152116015625000000e+05
+-1.177856171875000000e+05
+-1.159519375000000000e+05
+-1.165883906250000000e+05
+-1.182013125000000000e+05
+-1.189973984375000000e+05
+-1.173463906250000000e+05
+-1.197751015625000000e+05
+-1.190795468750000000e+05
+-1.200410468750000000e+05
+-1.218665000000000000e+05
+-1.188069687500000000e+05
+-1.206374375000000000e+05
+-1.197559531250000000e+05
+-1.209967968750000000e+05
+-1.212957265625000000e+05
+-1.212443828125000000e+05
+-1.195400781250000000e+05
+-1.230475078125000000e+05
+-1.226444531250000000e+05
+-1.213262031250000000e+05
+-1.218737578125000000e+05
+-1.195026015625000000e+05
+-1.209813828125000000e+05
+-1.197795000000000000e+05
+-1.246849531250000000e+05
+-1.196471718750000000e+05
+-1.220450312500000000e+05
+-1.247164609375000000e+05
+-1.208402578125000000e+05
+-1.213363984375000000e+05
+-1.203162031250000000e+05
+-1.219784296875000000e+05
+-1.193853437500000000e+05
+-1.213396171875000000e+05
+-1.223348281250000000e+05
+-1.216923593750000000e+05
+-1.201857500000000000e+05
+-1.199164062500000000e+05
+-1.231689062500000000e+05
+-1.205890234375000000e+05
+-1.212444609375000000e+05
+-1.193242812500000000e+05
+-1.207190000000000000e+05
+-1.200213437500000000e+05
+-1.212669921875000000e+05
+-1.212643593750000000e+05
+-1.203712734375000000e+05
+-1.218827734375000000e+05
+-1.194739765625000000e+05
+-1.207601796875000000e+05
+-1.226016328125000000e+05
+-1.215735234375000000e+05
+-1.198802890625000000e+05
+-1.199369218750000000e+05
+-1.207283593750000000e+05
+-1.215299765625000000e+05
+-1.206135625000000000e+05
+-1.202775390625000000e+05
+-1.202929765625000000e+05
+-1.220126484375000000e+05
+-1.208809375000000000e+05
+-1.238457187500000000e+05
+-1.225893593750000000e+05
+-1.224512812500000000e+05
+-1.242899062500000000e+05
+-1.222154296875000000e+05
+-1.230375312500000000e+05
+-1.218469765625000000e+05
+-1.223653203125000000e+05
+-1.228509296875000000e+05
+-1.236928203125000000e+05
+-1.221471406250000000e+05
+-1.241974218750000000e+05
+-1.218198281250000000e+05
+-1.234122109375000000e+05
+-1.239503203125000000e+05
+-1.231226406250000000e+05
+-1.229235625000000000e+05
+-1.232003671875000000e+05
+-1.240841796875000000e+05
+-1.244039062500000000e+05
+-1.236392031250000000e+05
+-1.229919609375000000e+05
+-1.233483437500000000e+05
+-1.235587578125000000e+05
+-1.235762109375000000e+05
+-1.224168984375000000e+05
+-1.232786093750000000e+05
+-1.224250390625000000e+05
+-1.251269218750000000e+05
+-1.244812421875000000e+05
+-1.231245000000000000e+05
+-1.272869296875000000e+05
+-1.263780703125000000e+05
+-1.231638984375000000e+05
+-1.250247968750000000e+05
+-1.255318437500000000e+05
+-1.250404921875000000e+05
+-1.245648125000000000e+05
+-1.254218125000000000e+05
+-1.225718203125000000e+05
+-1.228946875000000000e+05
+-1.250070234375000000e+05
+-1.245597812500000000e+05
+-1.230537187500000000e+05
+-1.240360234375000000e+05
+-1.235699765625000000e+05
+-1.230042578125000000e+05
+-1.240682968750000000e+05
+-1.218269218750000000e+05
+-1.240008437500000000e+05
+-1.247789375000000000e+05
+-1.240253906250000000e+05
+-1.237192031250000000e+05
+-1.255499062500000000e+05
+-1.246301484375000000e+05
+-1.239684765625000000e+05
+-1.261186093750000000e+05
+-1.265733125000000000e+05
+-1.234131093750000000e+05
+-1.248570468750000000e+05
+-1.236804921875000000e+05
+-1.250811015625000000e+05
+-1.244450625000000000e+05
+-1.254374375000000000e+05
+-1.250745390625000000e+05
+-1.225217500000000000e+05
+-1.233874765625000000e+05
+-1.239000078125000000e+05
+-1.255520312500000000e+05
+-1.243117031250000000e+05
+-1.226942890625000000e+05
+-1.246087890625000000e+05
+-1.227240312500000000e+05
+-1.244363671875000000e+05
+-1.233452265625000000e+05
+-1.223147890625000000e+05
+-1.224401093750000000e+05
+-1.226097968750000000e+05
+-1.257885234375000000e+05
+-1.242993984375000000e+05
+-1.241051406250000000e+05
+-1.249079609375000000e+05
+-1.245696718750000000e+05
+-1.224155468750000000e+05
+-1.240561328125000000e+05
+-1.274071171875000000e+05
+-1.252050078125000000e+05
+-1.234154218750000000e+05
+-1.236141171875000000e+05
+-1.270796562500000000e+05
+-1.263407968750000000e+05
+-1.272103515625000000e+05
+-1.252423515625000000e+05
+-1.265529687500000000e+05
+-1.269270000000000000e+05
+-1.263248125000000000e+05
+-1.271285703125000000e+05
+-1.256582265625000000e+05
+-1.251277265625000000e+05
+-1.261654765625000000e+05
+-1.251907031250000000e+05
+-1.268772500000000000e+05
+-1.279211796875000000e+05
+-1.301961171875000000e+05
+-1.295007734375000000e+05
+-1.298967812500000000e+05
+-1.297206718750000000e+05
+-1.313072031250000000e+05
+-1.324339843750000000e+05
+-1.299064609375000000e+05
+-1.313706093750000000e+05
+-1.329798125000000000e+05
+-1.310062031250000000e+05
+-1.345048281250000000e+05
+-1.328608437500000000e+05
+-1.309017031250000000e+05
+-1.319647031250000000e+05
+-1.340788593750000000e+05
+-1.359195937500000000e+05
+-1.339642187500000000e+05
+-1.329956250000000000e+05
+-1.337840625000000000e+05
+-1.334821875000000000e+05
+-1.320024375000000000e+05
+-1.359303750000000000e+05
+-1.355564062500000000e+05
+-1.361202656250000000e+05
+-1.362052968750000000e+05
+-1.353156875000000000e+05
+-1.337139218750000000e+05
+-1.355890625000000000e+05
+-1.365966250000000000e+05
+-1.343684218750000000e+05
+-1.353028750000000000e+05
+-1.359864062500000000e+05
+-1.341300625000000000e+05
+-1.367416875000000000e+05
+-1.340267812500000000e+05
+-1.370479062500000000e+05
+-1.344010000000000000e+05
+-1.352807343750000000e+05
+-1.356106875000000000e+05
+-1.339963750000000000e+05
+-1.332135937500000000e+05
diff --git a/CPSC532-HW4/results/loss_4_plot.png b/CPSC532-HW4/results/loss_4_plot.png
index 0e565ab..a6f5ab6 100644
Binary files a/CPSC532-HW4/results/loss_4_plot.png and b/CPSC532-HW4/results/loss_4_plot.png differ
diff --git a/CPSC532-HW4/results/params_4.pkl b/CPSC532-HW4/results/params_4.pkl
index c1f9b8c..89c4121 100644
Binary files a/CPSC532-HW4/results/params_4.pkl and b/CPSC532-HW4/results/params_4.pkl differ
diff --git a/CPSC532-HW4/run.py b/CPSC532-HW4/run.py
index 961dabb..8997e5a 100644
--- a/CPSC532-HW4/run.py
+++ b/CPSC532-HW4/run.py
@@ -15,7 +15,7 @@ from tests import is_tol, run_probabilistic_test, load_truth
 from general_sampling import get_sample, prior_samples
 from evaluation_based_sampling import abstract_syntax_tree
 from graph_based_sampling import graph
-from utils import wandb_plots, wandb_plots_homework3
+from utils import wandb_plots, wandb_plots_homework3, wandb_plots_homework4
 from BBVI import BBVI
 
 
@@ -133,7 +133,7 @@ def run_all(cfg):
     if bbvi:
         for program in programs:
             print("\nRunning BBVI on program {}...\n".format(program))
-            Q, results, loss = BBVI(program)
+            Q, results, loss = BBVI(program, wandb_name=entity, wandb_run=wandb_run)
 
             print("The resulting approximating distribution is : {}".format(Q))
             
@@ -146,9 +146,9 @@ def run_all(cfg):
 
                 np.savetxt("./results/loss_%d.dat"%(program), loss)
 
-                fig = plt.figure(figsize=(8,4))
-                plt.plot(loss)
-                fig.savefig("./results/loss_%d_plot.png"%(program))
+            if wandb_run:
+                samples = [tc.stack([Q[x].sample() for x in Q.keys()]) for _ in range(1e6)] 
+                wandb_plots_homework4(samples, program)
 
 
 
diff --git a/CPSC532-HW4/utils.py b/CPSC532-HW4/utils.py
index e0de2dc..72f4b46 100644
--- a/CPSC532-HW4/utils.py
+++ b/CPSC532-HW4/utils.py
@@ -124,7 +124,7 @@ def log_params(variationals: list, i: int, wandb_name: str) -> None:
     wandb.log(samples_dict)
 
 
-def log_loss(losses: dict, i: int, wandb_name: str) -> None:
+def log_loss(loss: dict, i: int, wandb_name: str) -> None:
     '''
     Log a set of losses corresponding to each node to W&B
     @params
@@ -134,8 +134,7 @@ def log_loss(losses: dict, i: int, wandb_name: str) -> None:
     '''
     wandb_name_here = wandb_name+' loss'
     wandb_dict = {wandb_name_here+'; epoch': i}
-    for node, loss in losses.items():
-        wandb_dict[wandb_name_here+'; '+node] = loss
+    wandb_dict[wandb_name_here+';'] = loss
     wandb.log(wandb_dict)
 
 def wandb_plots_homework4(samples, program):
